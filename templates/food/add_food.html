<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Th√™m th·ª±c ph·∫©m</title>
    <style>
        body { font-family: sans-serif; max-width: 500px; margin: 50px auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        label { display: block; margin-top: 10px; font-weight: bold; }
        input, select { width: 100%; padding: 8px; margin-top: 5px; box-sizing: border-box; }
        input[type=submit] { margin-top: 20px; background-color: #28a745; color: white; border: none; cursor: pointer; padding: 10px; font-size: 16px; }
        .back-link { display: block; margin-top: 15px; text-align: center; }
        
        /* Th√™m ch√∫t m√†u s·∫Øc cho ph·∫ßn l∆∞u √Ω */
        .hint { font-size: 0.85em; color: #666; font-style: italic; margin-top: 2px; }
    </style>
</head>
<body>
    <h2 style="text-align: center;">Th√™m v√†o T·ªß l·∫°nh üçé</h2>

    <form method="POST" action="{{ url_for('add_food') }}">
        <label for="name">T√™n th·ª±c ph·∫©m:</label>
        <input type="text" id="name" name="name" placeholder="V√≠ d·ª•: Tr·ª©ng g√†, S·ªØa t∆∞∆°i..." required>

        <div style="display: flex; gap: 10px;">
            <div style="flex: 1;">
                <label for="quantity">S·ªë l∆∞·ª£ng:</label>
                <input type="number" id="quantity" name="quantity" min="0" step="1" required placeholder="Nh·∫≠p s·ªë l∆∞·ª£ng">
                <div id="quantity-hint" class="hint">Nh·∫≠p s·ªë nguy√™n (1, 2, 3...)</div>
            </div>
            <div style="flex: 1;">
                <label for="unit">ƒê∆°n v·ªã:</label>
                <select id="unit" name="unit" onchange="updateQuantityInput()">
                    <option value="Qu·∫£">Qu·∫£</option>
                    <option value="H·ªôp">H·ªôp</option>
                    <option value="C√°i">C√°i</option>
                    <option value="Chai">Chai</option>
                    <option value="G√≥i">G√≥i</option>
                    
                    <option value="Kg">Kg</option>
                    <option value="L√≠t">L√≠t</option>
                    <option value="Gram">Gram</option>
                </select>
            </div>
        </div>

        <label for="location">V·ªã tr√≠:</label>
        <select id="location" name="location">
            <option value="NgƒÉn m√°t">‚ùÑÔ∏è NgƒÉn m√°t</option>
            <option value="NgƒÉn ƒë√°">üßä NgƒÉn ƒë√°</option>
            <option value="K·ªá rau c·ªß">ü•ï K·ªá rau c·ªß</option>
            <option value="C√°nh c·ª≠a">üö™ C√°nh c·ª≠a</option>
            <option value="T·ªß ƒë·ªì kh√¥">cabinet T·ªß ƒë·ªì kh√¥</option>
        </select>

        <label for="expiration_date">Ng√†y h·∫øt h·∫°n:</label>
        <input type="date" id="expiration_date" name="expiration_date" required>

        <input type="submit" value="Th√™m v√†o T·ªß l·∫°nh">
    </form>
    
    <div class="back-link">
        <a href="{{ url_for('home') }}">‚¨ÖÔ∏è Quay l·∫°i trang ch·ªß</a>
    </div>

    <script>
        function updateQuantityInput() {
            // 1. L·∫•y th·∫ª input s·ªë l∆∞·ª£ng v√† th·∫ª select ƒë∆°n v·ªã
            var quantityInput = document.getElementById("quantity");
            var unitSelect = document.getElementById("unit");
            var hintText = document.getElementById("quantity-hint");
            
            // 2. L·∫•y gi√° tr·ªã ƒë∆°n v·ªã ƒëang ƒë∆∞·ª£c ch·ªçn
            var selectedUnit = unitSelect.value;

            // 3. Danh s√°ch c√°c ƒë∆°n v·ªã ch·ªâ d√πng s·ªë nguy√™n (ƒë·∫øm ƒë∆∞·ª£c)
            var integerUnits = ["Qu·∫£", "H·ªôp", "C√°i", "Chai", "G√≥i"];

            // 4. Ki·ªÉm tra v√† thay ƒë·ªïi thu·ªôc t√≠nh c·ªßa √¥ nh·∫≠p
            if (integerUnits.includes(selectedUnit)) {
                // N·∫øu l√† ƒë·ªì ƒë·∫øm ƒë∆∞·ª£c: B·∫Øt bu·ªôc nh·∫≠p s·ªë nguy√™n (step = 1)
                quantityInput.step = "1";
                quantityInput.placeholder = "VD: 1, 5, 10";
                hintText.textContent = "Nh·∫≠p s·ªë nguy√™n (1, 2, 3...)";
                
                // (M·∫πo nh·ªè) N·∫øu ƒëang l·ª° nh·∫≠p 1.5 th√¨ t·ª± l√†m tr√≤n xu·ªëng 1
                if (quantityInput.value && quantityInput.value % 1 !== 0) {
                     quantityInput.value = Math.floor(quantityInput.value);
                }
            } else {
                // N·∫øu l√† Kg, L√≠t, Gram: Cho ph√©p nh·∫≠p s·ªë l·∫ª (step = 0.01)
                quantityInput.step = "0.01"; // Cho ph√©p nh·∫≠p l·∫ª nh∆∞ 0.5, 1.25
                quantityInput.placeholder = "VD: 0.5, 1.2";
                hintText.textContent = "C√≥ th·ªÉ nh·∫≠p s·ªë l·∫ª (0.5, 1.2...)";
            } 
        }

        // G·ªçi h√†m m·ªôt l·∫ßn ngay khi trang web t·∫£i xong ƒë·ªÉ thi·∫øt l·∫≠p tr·∫°ng th√°i ban ƒë·∫ßu
        window.onload = updateQuantityInput;
    </script>
</body>
</html>