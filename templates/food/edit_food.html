<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>S·ª≠a th·ª±c ph·∫©m</title>
    <style>
        body { font-family: sans-serif; max-width: 500px; margin: 50px auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        label { display: block; margin-top: 10px; font-weight: bold; }
        input, select { width: 100%; padding: 8px; margin-top: 5px; box-sizing: border-box; }
        input[type=submit] { margin-top: 20px; background-color: #ffc107; color: black; border: none; cursor: pointer; padding: 10px; font-size: 16px; }
    </style>
</head>
<body>
    <h2 style="text-align: center;">S·ª≠a th√¥ng tin: {{ food.name }}</h2>

    <form method="POST" action="{{ url_for('edit_food', id=food.id) }}">
        <label for="name">T√™n th·ª±c ph·∫©m:</label>
        <input type="text" id="name" name="name" value="{{ food.name }}" required>

        <div style="display: flex; gap: 10px;">
            <div style="flex: 1;">
                <label for="quantity">S·ªë l∆∞·ª£ng:</label>
                <input type="number" id="quantity" name="quantity"
                    value="{{ food.quantity | int if food.quantity % 1 == 0 else food.quantity }}" 
                    required>
                <div id="quantity-hint" style="font-size: 0.85em; color: #666; font-style: italic; margin-top: 2px;"></div>
            </div>
            <div style="flex: 1;">
                <label for="unit">ƒê∆°n v·ªã:</label>
                <select id="unit" name="unit" onchange="updateQuantityInput()">
                    <option value="Qu·∫£" {% if food.unit == 'Qu·∫£' %}selected{% endif %}>Qu·∫£</option>
                    <option value="H·ªôp" {% if food.unit == 'H·ªôp' %}selected{% endif %}>H·ªôp</option>
                    <option value="C√°i" {% if food.unit == 'C√°i' %}selected{% endif %}>C√°i</option>
                    <option value="Chai" {% if food.unit == 'Chai' %}selected{% endif %}>Chai</option>
                    <option value="G√≥i" {% if food.unit == 'G√≥i' %}selected{% endif %}>G√≥i</option>
                    <option value="Kg" {% if food.unit == 'Kg' %}selected{% endif %}>Kg</option>
                    <option value="L√≠t" {% if food.unit == 'L√≠t' %}selected{% endif %}>L√≠t</option>
                    <option value="Gram" {% if food.unit == 'Gram' %}selected{% endif %}>Gram</option>
                    </select>
            </div>
        </div>

        <label for="location">V·ªã tr√≠:</label>
        <select id="location" name="location">
            <option value="NgƒÉn m√°t" {% if food.location == 'NgƒÉn m√°t' %}selected{% endif %}>‚ùÑÔ∏è NgƒÉn m√°t</option>
            <option value="NgƒÉn ƒë√°" {% if food.location == 'NgƒÉn ƒë√°' %}selected{% endif %}>üßä NgƒÉn ƒë√°</option>
            <option value="K·ªá rau c·ªß" {% if food.location == 'K·ªá rau c·ªß' %}selected{% endif %}>ü•ï K·ªá rau c·ªß</option>
            <option value="C√°nh c·ª≠a" {% if food.location == 'C√°nh c·ª≠a' %}selected{% endif %}>üö™ C√°nh c·ª≠a</option>
            <option value="T·ªß ƒë·ªì kh√¥" {% if food.location == 'T·ªß ƒë·ªì kh√¥' %}selected{% endif %}>cabinet T·ªß ƒë·ªì kh√¥</option>
            </select>

        <label for="expiration_date">Ng√†y h·∫øt h·∫°n:</label>
        <input type="date" id="expiration_date" name="expiration_date" value="{{ food.expiration_date }}" required>

        <input type="submit" value="L∆∞u thay ƒë·ªïi">
    </form>
    
    <div style="text-align: center; margin-top: 15px;">
        <a href="{{ url_for('home') }}">H·ªßy b·ªè</a>
    </div>
    <script>
        function updateQuantityInput() {
            var quantityInput = document.getElementById("quantity");
            var unitSelect = document.getElementById("unit");
            var hintText = document.getElementById("quantity-hint"); 
            var selectedUnit = unitSelect.value;
            var integerUnits = ["Qu·∫£", "H·ªôp", "C√°i", "Chai", "G√≥i"];

            if (integerUnits.includes(selectedUnit)) {
                quantityInput.min = "1";
                quantityInput.step = "1";
                hintText.textContent = "Nh·∫≠p s·ªë nguy√™n (1, 2, 3...)";
                
                if (quantityInput.value && quantityInput.value % 1 !== 0) {
                     quantityInput.value = Math.floor(quantityInput.value);
                }
            } else {
                quantityInput.min = "0.01";
                quantityInput.step = "0.01";
                hintText.textContent = "C√≥ th·ªÉ nh·∫≠p s·ªë l·∫ª (0.5, 1.2...)";
            } 
        }

        // G·ªçi h√†m m·ªôt l·∫ßn ngay khi trang web t·∫£i xong ƒë·ªÉ thi·∫øt l·∫≠p tr·∫°ng th√°i ban ƒë·∫ßu
        window.onload = updateQuantityInput;
    </script>
</body>
</html>